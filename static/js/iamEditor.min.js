"use strict";var _createClass=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var IamEditor=function(){function e(){_classCallCheck(this,e),this.selection=window.getSelection()}return _createClass(e,[{key:"init",value:function(){var o=this;this.dom.setAttribute("contenteditable",!0),this.dom.addEventListener("keydown",function(e){console.log(e);var t=o.getRange();if(t.commonAncestorContainer.parentNode.getAttribute("unit")){var n=t.commonAncestorContainer;if(t.setStart(t.startContainer,0),t.setEnd(t.endContainer,n.length),-1==[37,38,39,40].indexOf(e.keyCode)&&t.commonAncestorContainer.parentNode.parentNode.removeChild(t.commonAncestorContainer.parentNode),8===e.keyCode)return!1}}),this.dom.addEventListener("paste",function(e){var t=e.clipboardData.getData("text/plain");document.execCommand("insertText",!1,t),e.preventDefault()}),document.addEventListener("click",function(e){if(o.dom.contains(e.target)&&e.target.getAttribute("unit")){var t=o.getRange(),n=t.commonAncestorContainer;t.setStart(t.startContainer,0),t.setEnd(t.endContainer,n.length)}})}},{key:"getRange",value:function(){return this.selection.getRangeAt(0)}},{key:"getBox",value:function(e){this.dom=e,this.init()}},{key:"focus",value:function(){this.dom.focus()}},{key:"insertHTML",value:function(e){this.focus(),document.execCommand("insertHTML",!1,e+"&#8203;");var t=this.getRange();t.setStart(t.endContainer,0),t.setEnd(t.endContainer,0)}},{key:"toUbb",value:function(){var e=this.dom.cloneNode(!0),t=e.querySelectorAll("[data-code]"),n=!0,o=!1,r=void 0;try{for(var a,i=t[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var c=a.value,s=c.dataset.code;c.parentNode.replaceChild(document.createTextNode(s),c)}}catch(e){o=!0,r=e}finally{try{!n&&i.return&&i.return()}finally{if(o)throw r}}return e.innerText}}]),e}();